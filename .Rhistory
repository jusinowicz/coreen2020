g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum )
g1_pred = as.vector(predict.gam(g1, newdata=n1,  type= "response") )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR )
g2_pred = as.vector(predict.gam(g2, newdata=n1,  type= "response") )
plot(g2)
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR )
g2_pred = as.vector(predict.gam(g2, newdata=n1,  type= "response") )
plot(g2)
head(g1_pred)
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
head(g1_pred)
n1 = data.frame( ai2_mean = seq(0,7,0.1) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = log(seq(0,7,0.1) ) )
g1 = gam( I(log(alg_Ninv_mean))~s(ai2_mean,k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
plot(g1)
g1 = gam( I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=4),data=aie_sum )
plot(g1)
n1 = data.frame( ai2_mean = log(seq(0.1,7,0.1) ) )
g1 = gam( I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
n1
n1 = data.frame( ai2_mean = (seq(0.1,7,0.1) ) )
g1 = gam( I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = (seq(0.1,7,0.1) ) )
g1 = gam( I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_y_log10()+scale_x_log10()+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) +
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_y_log10()+scale_x_log10()+
geom_line( data=g2_pred,  mapping=aes(y =exp(alg_Ninv_mean) , x = exp(ai2_mean),  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =exp(alg_Ninv_mean) , x =exp(ai2_mean),  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) +
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =exp(alg_Ninv_mean) , x = exp(ai2_mean),  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =exp(alg_Ninv_mean) , x =exp(ai2_mean),  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = (seq(0.1,7,0.1) ) )
g1 = gam( I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(I(log(alg_Ninv_mean))~s(I(log(ai2_mean)),k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =log(alg_Ninv_mean) , x = log(ai2_mean),  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =log(alg_Ninv_mean) , x = log(ai2_mean),  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + #scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = seq(0,7,0.1) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = seq(0.1,7,0.1) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum,family=Gamma(link=log) )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR,family=Gamma(link=log) )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
plot(g1)
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
plot(g2)
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR,family=Gamma(link=log) )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
plot(g2)
n1 = data.frame( ai2_mean = seq(0.1,7,0.1) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum,family=Gamma(link=log) )
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR,family=Gamma(link=log) )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = seq(0.1,7,0.1) )
#g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum,family=Gamma(link=log) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum)
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
#g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR,family=Gamma(link=log) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = seq(0.1,7,0.1) )
#g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum,family=Gamma(link=log) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum)
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
#g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR,family=Gamma(link=log) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
n1 = data.frame( ai2_mean = seq(0.5,7,0.1) )
#g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum,family=Gamma(link=log) )
g1 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sum)
g1_pred = cbind(n1, alg_Ninv_mean = as.vector(predict.gam(g1, newdata=n1,  type= "response") ) )
#g2 = gam(alg_Ninv_mean~s(ai2_mean,k=4),data=aie_sumR,family=Gamma(link=log) )
g2 = gam(alg_Ninv_mean~s(ai2_mean,k=3),data=aie_sumR )
g2_pred = cbind( n1,  alg_Ninv_mean = as.vector(predict.gam(g2, newdata=n1,  type= "response") ) )
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) 
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(), axis.ticks = element_blank())
ggsave("./ave_AlgvsComp_ai1ai2_var100_GAMS.pdf", width = 8, height = 10)
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Cost per individual (algae consumed/biomass) ")+
xlab("Complexity (bits of active information) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Cost per individual (algae consumed/biomass) ")+
xlab("Complexity (bits) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(), axis.ticks = element_blank())
ggsave("./ave_AlgvsComp_ai1ai2_var100_GAMS.pdf", width = 8, height = 10)
ggplot()+ 
geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =aiE_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =aiE_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =aiE_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =aiE_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Bits (AI) ")
#Algal consumption vs. temp.
ggplot()+ 
geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Temperature")
ggplot()+ 
geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Algae consumed per N")+
xlab("Temperature")
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(), axis.ticks = element_blank())
ggsave("./ave_AlgvsTemp_aiE_var100.pdf", width = 8, height = 10)
ggplot()+ 
geom_point( data=aie_sum,  mapping= aes(y =ai1_mean, x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =ai2_mean, x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
geom_point( data=aie_sumR,  mapping= aes(y =ai1_mean, x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =ai2_mean, x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) +
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Bits (AI) ")+
xlab("Temperature")
ggplot()+ 
geom_point( data=aie_sum,  mapping= aes(y =ai1_mean, x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =ai2_mean, x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
geom_point( data=aie_sumR,  mapping= aes(y =ai1_mean, x =temperature,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =ai2_mean, x =temperature,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) +
scale_color_discrete(name ="", labels = c("Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
ylab("Bits (AI) ")+
xlab("Temperature")
ggsave("./ave_CompvsTemp_ai1ai2_var100.pdf", width = 8, height = 10)
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 2 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 2 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
facet_grid(invade_monoculture~.) + scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ",size)+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=30 ))
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=30 ))
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=20 ))
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=18 ))
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=18 ))
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(), axis.ticks = element_blank())
ggsave("./ave_AlgvsComp_ai1ai2_var100_GAMS.pdf", width = 8, height = 10)
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=18 ))
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(), axis.ticks = element_blank())
ggsave("./ave_AlgvsComp_ai1ai2_var100_GAMS.pdf", width = 5, height = 5)
ggplot()+ 
#geom_point( data=aie_sum,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sum,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
#geom_point( data=aie_sumR,  mapping= aes(y =alg_Nres_mean , x =ai1_mean,  color = interaction( res_spp, nspp ) ) )  +
geom_point( data=aie_sumR,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ),size = 3 ) +  
scale_color_discrete(name ="", labels = c("GAM fit", "Daph Experiment", "Daph Simulation","Dia Experiment", "Dia Simulation" ) )+
geom_line( data=g2_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
geom_line( data=g1_pred,  mapping=aes(y =alg_Ninv_mean , x =ai2_mean,  color = interaction( inv_spp, nspp) ) ) +  
#facet_grid(invade_monoculture~.) +
scale_y_log10()+scale_x_log10()+
ylab("Cost per component (algae consumed/individual) ")+
xlab("Complexity (bits) ")+
theme(axis.text=element_text(size=15), axis.title=element_text(size=18 ))
#theme(axis.title.x=element_blank(),axis.text.x = element_blank(), axis.ticks = element_blank())
ggsave("./ave_AlgvsComp_ai1ai2_var100_GAMS.pdf", width = 8, height = 8)
m1_data_long %>% 
  ungroup() %>% 
  filter(!is.na(N)) %>% 
  ggplot(aes(x = day_n, y = N, color = species, group = interaction(species,replicate_number)))+
  geom_line()+
  facet_grid(temperature~invade_monoculture)+
  #scale_y_log10()+
  theme_bw()+
  scale_color_manual(values = c("dodgerblue1", "red1"), name = NA)+
  xlab("day")+
  ylab("population size")+
  theme(strip.background = element_rect(colour=NA, fill=NA))
aie_sum
aie_sumR
aie_sum
q()
